import pytest

from aoc.interval import _interval_diff, _interval_intersect


@pytest.mark.parametrize(
    "i1, i2, res",
    [
        # Fully contained:
        ((1, 10), (1, 10), set()),
        ((1, 10), (2, 10), {(1, 2)}),
        ((1, 10), (1, 9), {(9, 10)}),
        ((1, 10), (2, 9), {(1, 2), (9, 10)}),
        # Disjoint to fully contained:
        ((1, 10), (-5, 0), {(1, 10)}),
        ((1, 10), (-5, 1), {(1, 10)}),
        ((1, 10), (-5, 2), {(2, 10)}),
        ((1, 10), (-5, 9), {(9, 10)}),
        ((1, 10), (-5, 10), set()),
        ((1, 10), (-5, 11), set()),
        ((1, 10), (11, 15), {(1, 10)}),
        ((1, 10), (10, 15), {(1, 10)}),
        ((1, 10), (9, 15), {(1, 9)}),
        ((1, 10), (2, 15), {(1, 2)}),
        ((1, 10), (1, 15), set()),
        ((1, 10), (0, 15), set()),
    ],
)
def test_interval_diff_half(i1, i2, res):
    assert _interval_diff(i1, i2, 0) == res


@pytest.mark.parametrize(
    "i1, i2, res",
    [
        # Fully contained:
        ((1, 10), (1, 10), set()),
        ((1, 10), (2, 10), {(1, 1)}),
        ((1, 10), (1, 9), {(10, 10)}),
        ((1, 10), (2, 9), {(1, 1), (10, 10)}),
        # Disjoint to fully contained:
        ((1, 10), (-5, 0), {(1, 10)}),
        ((1, 10), (-5, 1), {(2, 10)}),
        ((1, 10), (-5, 2), {(3, 10)}),
        ((1, 10), (-5, 9), {(10, 10)}),
        ((1, 10), (-5, 10), set()),
        ((1, 10), (-5, 11), set()),
        ((1, 10), (11, 15), {(1, 10)}),
        ((1, 10), (10, 15), {(1, 9)}),
        ((1, 10), (9, 15), {(1, 8)}),
        ((1, 10), (2, 15), {(1, 1)}),
        ((1, 10), (1, 15), set()),
        ((1, 10), (0, 15), set()),
    ],
)
def test_interval_diff_closed(i1, i2, res):
    assert _interval_diff(i1, i2, 1) == res


@pytest.mark.parametrize(
    "i1, i2, res",
    [
        # Fully contained:
        ((1, 10), (1, 10), {(1, 10)}),
        ((1, 10), (2, 10), {(2, 10)}),
        ((1, 10), (1, 9), {(1, 9)}),
        ((1, 10), (2, 9), {(2, 9)}),
        # Disjoint to fully contained:
        ((1, 10), (-5, 0), set()),
        ((1, 10), (-5, 1), set()),
        ((1, 10), (-5, 2), {(1, 2)}),
        ((1, 10), (-5, 9), {(1, 9)}),
        ((1, 10), (-5, 10), {(1, 10)}),
        ((1, 10), (-5, 11), {(1, 10)}),
        ((1, 10), (11, 15), set()),
        ((1, 10), (10, 15), set()),
        ((1, 10), (9, 15), {(9, 10)}),
        ((1, 10), (2, 15), {(2, 10)}),
        ((1, 10), (1, 15), {(1, 10)}),
        ((1, 10), (0, 15), {(1, 10)}),
    ],
)
def test_interval_intersect_half(i1, i2, res):
    assert _interval_intersect(i1, i2, 0) == res


@pytest.mark.parametrize(
    "i1, i2, res",
    [
        # Fully contained:
        ((1, 10), (1, 10), {(1, 10)}),
        ((1, 10), (2, 10), {(2, 10)}),
        ((1, 10), (1, 9), {(1, 9)}),
        ((1, 10), (2, 9), {(2, 9)}),
        # Disjoint to fully contained:
        ((1, 10), (-5, 0), set()),
        ((1, 10), (-5, 1), {(1, 1)}),
        ((1, 10), (-5, 2), {(1, 2)}),
        ((1, 10), (-5, 9), {(1, 9)}),
        ((1, 10), (-5, 10), {(1, 10)}),
        ((1, 10), (-5, 11), {(1, 10)}),
        ((1, 10), (11, 15), set()),
        ((1, 10), (10, 15), {(10, 10)}),
        ((1, 10), (9, 15), {(9, 10)}),
        ((1, 10), (2, 15), {(2, 10)}),
        ((1, 10), (1, 15), {(1, 10)}),
        ((1, 10), (0, 15), {(1, 10)}),
    ],
)
def test_interval_intersect_closed(i1, i2, res):
    assert _interval_intersect(i1, i2, 1) == res
